---
title: buu-RE-maze-花指令
tags:
  - buu
  - RE
  - 花指令
abbrlink: b023ed3c
date: 2021-04-01 21:05:55
---

## 初识

下载文件并解压后，首先放入PEID检测



发现有UPX壳，快速脱壳后，再次检测，为VC++编写的32位程序，拖入IDA进行进一步分析

## 相知

一打开首先发现main函数无法编译，有一个地方函数出现了错误，初步判定为**花指令**，再查看字符串列表



由此可知，关键词并没有被IDA解析出引用，因此判定应该关键部分都在main函数内，那么下一步，就是把这个花指令处理以后就知道应该如何操作了

## 整活

在这一部分有一个jnz，有一个call，其中jnz函数只是往下跳了一行，因此应该为花指令，将其nop掉，发现下部分函数还是有错误，那函数内部还是有花指令，继续把这个函数转为数据模式



逐个NOP尝试后，发现只有将`0E8h`NOP以后后面的函数数据就会正常



接着再把这些数据转换回函数,反编译



接着回溯`asc_408078`和`dword_40807C`两个关键数据



由此可得最终的题意：初始的坐标为(7,0)最后要走到(5,-4)，然后将迷宫排版出来

